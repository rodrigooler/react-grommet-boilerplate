'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _path = require('path');

var _path2 = _interopRequireDefault(_path);

var _fs = require('fs');

var _fs2 = _interopRequireDefault(_fs);

var _eslint = require('eslint');

var _cli = require('../utils/cli');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
* NPM dependencies
**/
/**
* NPM dependencies
**/
var config = (0, _cli.loadConfig)();

/**
* Local dependencies
**/


var eslintrcPath = _path2.default.resolve(config.base, '.eslintrc');
try {
  _fs2.default.accessSync(eslintrcPath, _fs2.default.F_OK);
} catch (e) {
  eslintrcPath = _path2.default.resolve(__dirname, '../../.eslintrc');
}

process.on('message', function (paths) {
  var eslint = new _eslint.CLIEngine({
    configFile: eslintrcPath,
    cwd: config.base
  });
  process.send(eslint.executeOnFiles(paths));
});

exports.default = function (paths) {
  return new Promise(function (resolve) {
    var eslint = new _eslint.CLIEngine({
      configFile: eslintrcPath,
      cwd: config.base
    });
    resolve(eslint.executeOnFiles(paths));
  });
};